{% extends "base.html" %}

{% block title %}Account Settings - JobKit{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto space-y-8">
    <h1 class="text-2xl font-bold text-gray-900">Account Settings</h1>

    <!-- Email Verification Banner -->
    <div id="verify-banner" class="hidden bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center justify-between">
        <div>
            <span class="text-yellow-800 font-medium">Email not verified.</span>
            <span class="text-yellow-700 text-sm ml-1">Check your inbox or resend the verification email.</span>
        </div>
        <button id="resend-btn"
            class="flex-shrink-0 ml-4 px-3 py-1.5 bg-yellow-600 text-white text-sm rounded-lg hover:bg-yellow-700 transition">
            Resend
        </button>
    </div>

    <!-- Profile Section -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Profile</h2>
        <form id="profile-form" class="space-y-4">
            <div>
                <label for="profile-name" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                <input type="text" id="profile-name"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
            </div>
            <div>
                <label for="profile-email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                <input type="email" id="profile-email"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
            </div>
            <div id="profile-msg" class="hidden text-sm rounded-lg p-3"></div>
            <button type="submit" id="profile-btn"
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50">
                Save Changes
            </button>
        </form>
    </div>

    <!-- Change Password Section -->
    <div class="bg-white rounded-xl shadow-sm p-6">
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Change Password</h2>
        <form id="password-form" class="space-y-4">
            <div>
                <label for="current-password" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
                <input type="password" id="current-password" required autocomplete="current-password"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
            </div>
            <div>
                <label for="new-password" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
                <input type="password" id="new-password" required autocomplete="new-password"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition"
                    >
                <div class="mt-2 space-y-1">
                    <div class="w-full h-1.5 bg-gray-200 rounded-full overflow-hidden">
                        <div id="new-strength-bar" class="h-full rounded-full bg-gray-300 transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div class="grid grid-cols-2 gap-1 text-xs">
                        <span id="new-check-length" class="text-gray-300">✓ 8+ characters</span>
                        <span id="new-check-upper" class="text-gray-300">✓ Uppercase letter</span>
                        <span id="new-check-lower" class="text-gray-300">✓ Lowercase letter</span>
                        <span id="new-check-digit" class="text-gray-300">✓ Number</span>
                    </div>
                </div>
            </div>
            <div>
                <label for="confirm-new-password" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
                <input type="password" id="confirm-new-password" required autocomplete="new-password"
                    class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition">
            </div>
            <div id="password-msg" class="hidden text-sm rounded-lg p-3"></div>
            <button type="submit" id="password-btn"
                class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50">
                Change Password
            </button>
        </form>
    </div>

    <!-- Danger Zone -->
    <div class="bg-white rounded-xl shadow-sm p-6 border border-red-200">
        <h2 class="text-lg font-semibold text-red-600 mb-2">Danger Zone</h2>
        <p class="text-sm text-gray-500 mb-4">Permanently delete your account and all associated data. This action cannot be undone.</p>
        <button id="delete-account-btn" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition">
            Delete Account
        </button>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="delete-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center">
    <div id="delete-modal-backdrop" class="absolute inset-0 bg-black bg-opacity-50"></div>
    <div class="relative bg-white rounded-xl shadow-xl p-6 max-w-sm mx-4 w-full">
        <h3 class="text-lg font-bold text-gray-900 mb-2">Delete Account?</h3>
        <p class="text-sm text-gray-600 mb-4">
            This will permanently delete your account, all applications, contacts, companies, and messages.
            Type <strong>DELETE</strong> to confirm.
        </p>
        <input type="text" id="delete-confirm-input"
            class="w-full px-3 py-2 border border-gray-300 rounded-lg mb-3 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none"
            placeholder="Type DELETE">
        <div id="delete-password-field">
            <input type="password" id="delete-password-input"
                class="w-full px-3 py-2 border border-gray-300 rounded-lg mb-4 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none"
                placeholder="Enter your password to confirm">
        </div>
        <div class="flex gap-3 justify-end">
            <button id="delete-cancel-btn" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition text-sm">
                Cancel
            </button>
            <button id="delete-btn"
                class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm disabled:opacity-50">
                Delete Forever
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/account.js"></script>
{% endblock %}
